tables:
  banks:
    fields:
      id: {type: int, length: 10, auto_increment: 1, notnull: 1, am: {type: integer}}
      title: {type: tinytext, notnull: 1, am: {type: string, req: 1, title: Название}}
      pos: {type: int, length: 10, unsigned: 1, notnull: 1, am: {type: integer, htmltype: hidden}}
      country_id: {type: int, length: 10, notnull: 1, am: {type: select, title: Страна, null: не выбрано}}
      code: {type: varchar, length: '255', notnull: 1, am: {type: string, req: 1, title: SWIFT-код, trimNE: 'Поле "Код" не должно быть пустым'}}
      price_final: {type: tinytext, notnull: 0, am: {type: string, req: 0, title: Цена для заявки}}
      currencies:
        virtual: 1
        ref_to:
          virtual: 1
          table: currencies
          fields: [id, title]
          use_ref: banks2currencies
        am: {type: checkboxes, title: Валюта, del: ' ', field_name: title, title_field: title}
      active: {type: enum('yes','no'), default: 'yes', notnull: 1, am: {type: checkbox, title: Отображать на сайте, otitle: Отображать на сайте, default: 'yes', checked: 'yes', unchecked: 'no', values: {no: нет, yes: да}}}
    table:
      PRIMARY KEY: id
      KEYS: 
        pos: [pos]
        active: [active]
        code: [code]
    actions:
      list: [id, pos, title, country_id, code, price_final, currencies, active]
      show: [title, country_id, code, price_final, currencies, active]
      modify: [title, country_id, code, price_final, currencies, active]
      add: [pos, title, country_id, code, price_final, currencies, active]
      currencies: [currencies]

  currencies:
    dont_install: 1
    fields:
      id: {type: int, length: 10, auto_increment: 1, notnull: 1, am: {type: integer}}
      title: {type: tinytext, notnull: 1, am: {type: string, req: 1, title: Название}}
      pos: {type: int, length: 10, unsigned: 1, notnull: 1, am: {type: integer, htmltype: hidden}}
      active: {type: enum('yes','no'), default: 'yes', notnull: 1, am: {type: checkbox, title: Отображать на сайте, otitle: Отображать на сайте, default: 'yes', checked: 'yes', unchecked: 'no', values: {no: нет, yes: да}}}

  banks2currencies:
    fields:
      bank_id: {type: int, notnull: 1, unsigned: 1, am: {type: select, title: Банк}}
      currency_id: {type: int, notnull: 1, unsigned: 1, am: {type: select, title: Валюта}}
    table:
      UNIQUE:
        bank_currency: [bank_id, currency_id]

  countries:
    dont_install: 1
    fields:
      id: {type: int, length: 10, auto_increment: 1, notnull: 1, am: {type: integer}}
      title: {type: tinytext, notnull: 1, am: {type: string, req: 1, title: Название}}
      price: {type: tinytext, notnull: 0, am: {type: string, req: 0, title: Цена}}
      text: {type: text, notnull: 0, am: {type: ckhtml, htmltype: ckhtml, req: 0, title: Текст}}
      flag: {type: tinytext, notnull: 0, am: {type: image, title: Флаг}}
      pos: {type: int, length: 10, unsigned: 1, notnull: 1, am: {type: integer, htmltype: hidden}}
      code: {type: varchar, length: '255', notnull: 1, am: {type: integer, req: 1, title: Код, trimNE: 'Поле "Код" не должно быть пустым'}}
      in_list: {type: enum('yes','no'), default: 'no', notnull: 1, am: {type: string, title: Отображать в списке стран, htmltype: checkbox, default: 'no', checked: 'yes', unchecked: 'no', values: {no: нет, yes: да}}}
      source: {type: enum('yes','no'), default: 'no', notnull: 1, am: {type: string, title: Отображать в списке стран источников, htmltype: checkbox, default: 'no', checked: 'yes', unchecked: 'no', values: {no: нет, yes: да}}}
      receiver: {type: enum('yes','no'), default: 'no', notnull: 1, am: {type: string, title: Отображать в списке стран приемников, htmltype: checkbox, default: 'no', checked: 'yes', unchecked: 'no', values: {no: нет, yes: да}}}
      active: {type: enum('yes','no'), default: 'yes', notnull: 1, am: {type: string, title: Отображать на сайте, htmltype: checkbox, default: 'yes', checked: 'yes', unchecked: 'no', values: {no: нет, yes: да}}}
      quotation: {type: enum('red','green'), default: 'red', notnull: 1, am: {type: string, title: Котировка, htmltype: checkbox, default: 'red', checked: 'red', unchecked: 'green', values: {red: красная, green: зеленая}}}

refs:
  banks2currencies:
    virtual: 1
    join: left outer
    type: N-M
    tables:
      -
        - {table: banks, field: id}
        - {table: banks2currencies, field: bank_id}
      -
        - {table: banks2currencies, field: currency_id}
        - {table: currencies, field: id}
